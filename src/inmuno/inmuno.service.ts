import { Injectable } from '@nestjs/common';
import { animationFrame } from 'rxjs';
const fs = require('fs')
const fetch = require('node-fetch');


@Injectable()
export class InmunoService {
  RUTA_CARGAR = process.env.RUTA

  descargarRptPlano() {

    const rpt = fs.createWriteStream('./mayo20201.csv');
    const dest = fs.createWriteStream('./PACIENTE.csv');

    fetch("https://wsalud.minsa.gob.pe/reporteshis/his/NominalTramaNuevo.aspx?parametro=7-7-----20190101-20190131", {
      "headers": {
        "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
        "accept-language": "es-ES,es;q=0.9,en;q=0.8",
        "cache-control": "no-cache",
        "content-type": "application/x-www-form-urlencoded",
        "pragma": "no-cache",
        "sec-fetch-dest": "iframe",
        "sec-fetch-mode": "navigate",
        "sec-fetch-site": "same-origin",
        "sec-fetch-user": "?1",
        "upgrade-insecure-requests": "1",
        "cookie": "_ga=GA1.3.2012850145.1568573608; __cfduid=d46499b35542facd31f0e4f4f12ad92541602259280; rxVisitor=1603823334071H7F048O6UFUH47TL5KMLAJE01T1NVVKF; ASP.NET_SessionId=s1aoilx1hsyonuvwjpmhip2k; dtSa=true%7CC%7C-1%7Cmlkuser%7C-%7C1604328192888%7C525672842_0%7Chttps%3A%2F%2Fwebsalud.minsa.gob.pe%2Fhisminsa%2F%7CHIS%20MINSA%7C1604328191950%7C; dtPC=2$528203045_723h-vKAJKAIPPKHBOLGFEDKOGNLJVHMKNGBNP; dtCookie=2$C6AF3BBAE598A73479D3CDCE1FCC65FE|HISMINSA|1; rxvt=1604330007109|1604325672864; dtLatC=3"
      },
      "referrer": "https://wsalud.minsa.gob.pe/reporteshis/his/NominalTramaNuevo.aspx?parametro=7-7-----20190301-20190331",
      "referrerPolicy": "strict-origin-when-cross-origin",
      "body": "__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwULLTEwMTQzMzA4NTAPZBYCAgMPZBYEAgMPDxYCHgRUZXh0BRpUb3RhbCBkZSByZWdpc3Ryb3MgMTU1MTU3MGRkAgUPPCsAHAIADxYCHg9EYXRhU291cmNlQm91bmRnZBg8KwAGAQUUKwACZGRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQJndtLV3n2FDmg4HH8cE74NcIyWylxKCUbKJnthBV9BMVtv&__VIEWSTATEGENERATOR=40BBBC33&__EVENTVALIDATION=%2FwEdAAuYsVkFRM9tOyfTcH39pYil60z594LnSzU4S6PQAbT3rq%2FpNZX4WBzijQTqPezGz2dA7gw86B%2By7ZHTN%2BvyabRRNnYkKrbN%2FO3%2F80cAQIl6hUr4E8rNR8j1g%2BULBBtNNPuHCckrAtLUuxosmebAadYwj4xXkHQ%2BYn1IHjIKmCBZQcd656%2BJOgSd%2B0%2FH49X4pDTceTYcQ5kHq6daWfdlKKqcYwT%2BSUyhF5e0clSSWBJgLgh%2BDkRYSjUwr6PEzgguIZv9PTc48jriT4dQE16x059b&btnExportar=Exportar+a+Excel&gv%24DXSelInput=&gv%24DXKVInput=%5B%5D&gv%24CallbackState=BwMHAgIERGF0YQbrCAAAAADSrBcA0qwXAAAAAAAPAAAAAA8AAAAHSWRfQ2l0YQdJZF9DaXRhAwAABEFuaW8EQW5pbwMAAANNZXMDTWVzAwAAA0RpYQNEaWEDAAAORmVjaGFfQXRlbmNpb24ORmVjaGFfQXRlbmNpb24HAAAETG90ZQRMb3RlBwAAB051bV9QYWcHTnVtX1BhZwMAAAdOdW1fUmVnB051bV9SZWcDAAASSWRfRXN0YWJsZWNpbWllbnRvEklkX0VzdGFibGVjaW1pZW50bwMAAAtJZF9QYWNpZW50ZQtJZF9QYWNpZW50ZQcAAAtJZF9QZXJzb25hbAtJZF9QZXJzb25hbAcAAA5JZF9SZWdpc3RyYWRvcg5JZF9SZWdpc3RyYWRvcgMAAAtDb2RpZ29fSXRlbQtDb2RpZ29fSXRlbQcAABBUaXBvX0RpYWdub3N0aWNvEFRpcG9fRGlhZ25vc3RpY28HAAAJVmFsb3JfTGFiCVZhbG9yX0xhYgcAABkAAAAGSWRfVXBzDklkX0ZpbmFuY2lhZG9yHElkX0NvbmRpY2lvbl9Fc3RhYmxlY2ltaWVudG8VSWRfQ29uZGljaW9uX1NlcnZpY2lvCEVkYWRfUmVnCVRpcG9fRWRhZBRBbmlvX0FjdHVhbF9QYWNpZW50ZRNNZXNfQWN0dWFsX1BhY2llbnRlE0RpYV9BY3R1YWxfUGFjaWVudGUISWRfVHVybm8OSWRfQ29ycmVsYXRpdm8SSWRfQ29ycmVsYXRpdm9fTGFiBFBlc28FVGFsbGELSGVtb2dsb2JpbmETUGVyaW1ldHJvX0FiZG9taW5hbBJQZXJpbWV0cm9fQ2VmYWxpY28RSWRfT3RyYV9Db25kaWNpb24RSWRfQ2VudHJvX1BvYmxhZG8SRmVjaGFfVWx0aW1hX1JlZ2xhEkZlY2hhX1NvbGljaXR1ZF9IYhJGZWNoYV9SZXN1bHRhZG9fSGIORmVjaGFfUmVnaXN0cm8SRmVjaGFfTW9kaWZpY2FjaW9uB0lkX1BhaXMHAAcABwAHAAb%2F%2FwMFwccSDAMG4wcDBwEDBwEHAgoyMDE5LTAxLTAxBwIBNQMHAQMHCwMGiREHAgwyMDgzNjM5NzQ0ODkHAgo0NjE4Nzg0NDg5AwXSozwABwIETjM5MAcCAUQHAgAHAAcABv%2F%2FAwXfcwUMAwbjBwMHAQMHAQcCCjIwMTktMDEtMDEHAgIwMwMHAQMHAwMGFRIHAgZBUFAxMzYHAgwyOTgwODU0OTQ2MjkDBbDDVAAHAgVDMDAwOQcCAUQHAgE0BwAHAAb%2F%2FwMFCf86DAMG4wcDBwEDBwEHAgoyMDE5LTAxLTAxBwIBMQMHAQMHAgMGdxIHAgszNTc5OTE5NDcyNwcCCjEzMTI1NzQ3MjcDBhM9BwIEUzAxNAcCAUQMBwAHAAb%2F%2FwMFppsKFAMG4wcDBwEDBwEHAgoyMDE5LTAxLTAxBwICUzQDBwEDBwkDBowTBwIMMjUzNjYxMjI1MDA0BwIKNDY0ODM4NTAwNAMFwxcHAAcCBTgxMDAyBwIBRAcCAlJOBwAHAAb%2F%2FwMFfFDyCwMG4wcDBwEDBwEHAgoyMDE5LTAxLTAxBwIBMQMHDgMHBAMG4hEHAgwxNzkzNjY2NzQ1NzgHAgwyODk2MjE5OTQ1NzgDBQ0PBwAHAgU5OTQwMQcCAUQHAgExBwAHAAb%2F%2FwMFfFDyCwMG4wcDBwEDBwEHAgoyMDE5LTAxLTAxBwIBMQMHDgMHBAMG4hEHAgwxNzkzNjY2NzQ1NzgHAgwyODk2MjE5OTQ1NzgDBQ0PBwAHAgVDODAwMgcCAUQHAgExBwAHAAb%2F%2FwMFfFDyCwMG4wcDBwEDBwEHAgoyMDE5LTAxLTAxBwIBMQMHDgMHBAMG4hEHAgwxNzkzNjY2NzQ1NzgHAgwyODk2MjE5OTQ1NzgDBQ0PBwAHAgRJMTBYBwIBUgwHAAcABv%2F%2FAwV8UPILAwbjBwMHAQMHAQcCCjIwMTktMDEtMDEHAgExAwcOAwcEAwbiEQcCDDE3OTM2NjY3NDU3OAcCDDI4OTYyMTk5NDU3OAMFDQ8HAAcCBFowMDgHAgFEBwIBRQcABwAG%2F%2F8DBdZjChQDBuMHAwcBAwcBBwIKMjAxOS0wMS0wMQcCATcDBwIDBwQDBh8cBwIMMTc3ODcxNjQ3MTk5BwILMjg3MTI5MTcxOTkDBZ0AJAAHAgRLMzBYBwIBRAwHAAcABv%2F%2FAwX7e%2FwLAwbjBwMHAQMHAQcCCjIwMTktMDEtMDEHAgExAwcCAwcBAwYoLwcCDTM3NjQ2NTQ1MTIwNzIHAgs0NjUzODcxMjA3MgMFfMYFAAcCBFowMDYHAgFEBwICRUQHAAcABv%2F%2FAwUFTRkMAwbjBwMHAQMHAQcCCjIwMTktMDEtMDEHAgExAwcBAwcLAwbrJgcCDDIyMjI4NjgwOTk2MwcCDDM3NDg2MDc5OTk2MwMFWM14AQcCCDk5NDAyLjA4BwIBRAcCATEHAAcABv%2F%2FAwVlkRoMAwbjBwMHAQMHAQcCCjIwMTktMDEtMDEHAgExAwcCAwcCAwaVJgcCDDI0MDgzNDc2OTg3NwcCCjQ3MDY0Mjk4NzcDBaCzqAEHAgRKMDM5BwIBRAwHAAcABv%2F%2FAwWNbPELAwbjBwMHAQMHAQcCCjIwMTktMDEtMDEHAgNRMDMDBwEDBwEDBioSBwIMMTk5ODAxODM0NjUwBwIMMTgwMTg2MTk0NjUwAwVZjjgCBwIFWjMwNDgHAgFEBwIBNAcABwAG%2F%2F8DBY1s8QsDBuMHAwcBAwcBBwIKMjAxOS0wMS0wMQcCA1EwMwMHAQMHAQMGKhIHAgwxOTk4MDE4MzQ2NTAHAgwxODAxODYxOTQ2NTADBVmOOAIHAgVaMzA0OAcCAUQHAgIzMAcABwAG%2F%2F8DBaREnQ4DBuMHAwcBAwcBBwIKMjAxOS0wMS0wMQcCAUcDBwEDBwEDBpETBwIMMzYzOTI5OTU1MDA5BwIMMjAzOTUwMTY1MDA5AwXV%2BWoBBwIFOTk0MTEHAgFEBwIBNgIFU3RhdGUHcwcQBwACAQcBAgEHAgIBBwMCAQcEAgEHBQIBBwYCAQcHAgEHCAIBBwkCAQcKAgEHCwIBBwwCAQcNAgEHDgIBBw8CAQcABwAHAAcAAgAFAAAAgAkCAAcACQIAAgADBwQCAAcAAgEF0qwXAAcAAgEHAAcABwACCFBhZ2VTaXplAwcP&hdpidsector=7&hdpiddisa=7&hdpidred=&hdpidmicrored=&hdpidestablecimiento=&hdpidpunto=7759&hdpfecini=20200501&hdpfecfin=20200531&DXScript=1_171%2C1_94%2C1_164%2C1_104%2C1_138%2C1_114%2C1_121%2C1_152&DXCss=0_3598%2C0_3741%2C1_12%2C0_3600%2C0_3745%2C0_3592%2C1_5%2C0_3594",
      "method": "POST",
      "mode": "cors"
    }).then(res => {
      console.log('inicio')
      console.log(res)
      res.body.pipe(rpt);
      console.log('termino')

    });




    fetch("https://wsalud.minsa.gob.pe/reporteshis/his/ExportarMaestroPaciente.aspx?parametro=7758-7-08-01-20201123-20201123-", {
      "headers": {
        "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
        "accept-language": "es-ES,es;q=0.9,en;q=0.8",
        "cache-control": "no-cache",
        "content-type": "application/x-www-form-urlencoded",
        "pragma": "no-cache",
        "sec-fetch-dest": "iframe",
        "sec-fetch-mode": "navigate",
        "sec-fetch-site": "same-origin",
        "sec-fetch-user": "?1",
        "upgrade-insecure-requests": "1",
        "cookie": "_ga=GA1.3.2012850145.1568573608; __cfduid=d455db6626cff542e92e41f50bf3077e71604958158; rxVisitor=1606006205279UM3J2CU0EVB0B3NA2T64IS2MMQG8OLBL; ASP.NET_SessionId=xmqcd4hhuipaeyre2skgvl1k; dtSa=-; dtPC=3$508208698_818h-vIQXMPVLCBEVVOHXYAUUBBXMVFLSUVMSP; dtLatC=1; dtCookie=3$9NUBFSES42MTE6SV6SR7PJBM28KTMBQG|HISMINSA|1; rxvt=1606110012749|1606106956076"
      },
      "referrer": "https://wsalud.minsa.gob.pe/reporteshis/his/ExportarMaestroPaciente.aspx?parametro=7758-7-08-01-20201123-20201123-",
      "referrerPolicy": "strict-origin-when-cross-origin",
      "body": "__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUKMTEwNzU3MTUxNA9kFgICAw9kFgQCAw8PFgIeBFRleHQFF1RvdGFsIGRlIHJlZ2lzdHJvcyA0ODgxZGQCBQ88KwAcAgAPFgIeD0RhdGFTb3VyY2VCb3VuZGdkGDwrAAYBBRQrAAJkZGQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFAmd2jUDub3Vh2sBa4rU87h1ZP8C0d2g8bSm8M5EBAMM5c70%3D&__VIEWSTATEGENERATOR=7CA80B8B&__EVENTVALIDATION=%2FwEdAAvNvw%2FGT8%2BwO0s0HO5H6Vg560z594LnSzU4S6PQAbT3rq%2FpNZX4WBzijQTqPezGz2cPw6yb2%2B8wFVL9OLFMP7J7pAiCeLToo4O3HlO4yQxlIfvcNFoQPNiM7bg%2FOngY3P4BkA6huflNnawEEAJHB5G4AuunurLj5OiQui6dRwAtUPWzZLxWMw9LZCkW1r1wQWtVmqd7cYVwF0CgV957j5RekmEIlqWRw%2Bgtywck79wWECW8pnUzPlOmXPu6xya0FuQ3UzRLp7%2FD57fuX%2FJsXBx%2B&btnExportar=Exportar+a+Excel&gv%24DXSelInput=&gv%24DXKVInput=%5B%5D&gv%24CallbackState=BwMHAgIERGF0YQbHBgAAAAAREwAAERMAAAAAAAAPAAAAAAcAAAALSWRfUGFjaWVudGULSWRfUGFjaWVudGUHAAARSWRfVGlwb19Eb2N1bWVudG8RSWRfVGlwb19Eb2N1bWVudG8DAAAQTnVtZXJvX0RvY3VtZW50bxBOdW1lcm9fRG9jdW1lbnRvBwAAGUFwZWxsaWRvX1BhdGVybm9fUGFjaWVudGUZQXBlbGxpZG9fUGF0ZXJub19QYWNpZW50ZQcAABlBcGVsbGlkb19NYXRlcm5vX1BhY2llbnRlGUFwZWxsaWRvX01hdGVybm9fUGFjaWVudGUHAAAQTm9tYnJlc19QYWNpZW50ZRBOb21icmVzX1BhY2llbnRlBwAAEEZlY2hhX05hY2ltaWVudG8QRmVjaGFfTmFjaW1pZW50bwcAAA4AAAAGR2VuZXJvCElkX0V0bmlhEEhpc3RvcmlhX0NsaW5pY2EORmljaGFfRmFtaWxpYXIRVWJpZ2VvX05hY2ltaWVudG8NVWJpZ2VvX1JlbmllYxBEb21pY2lsaW9fUmVuaWVjEFViaWdlb19EZWNsYXJhZG8TRG9taWNpbGlvX0RlY2xhcmFkbxRSZWZlcmVuY2lhX0RvbWljaWxpbwdJZF9QYWlzEklkX0VzdGFibGVjaW1pZW50bwpGZWNoYV9BbHRhEkZlY2hhX01vZGlmaWNhY2lvbgcABwAHAAcABv%2F%2FBwIMMTAwMzQyOTg0NTM5AwcBBwIIMjcxNjkzMTMHAgZOVcORRVoHAgVNQUxDQQcCBUhJTERBBwIKMTk3MS0wNi0yMQcABwAG%2F%2F8HAgwxMDAzNTc2NDQ1MzcDBwEHAgg0NDU2OTE2MQcCCUhFUk5BTkRFWgcCB1JBTUlSRVoHAgxTQU5UQSBZU0FCRUwHAgoxOTg0LTExLTAxBwAHAAb%2F%2FwcCDDEwMzUwNjQwNDUzOAMHAQcCCDI4MDYzNDYwBwIFVEVSQU4HAglIRVJOQU5ERVoHAg5XQUxURVIgT1JMQU5ETwcCCjE5NjItMDMtMjMHAAcABv%2F%2FBwIMMTAzNTIyMjk0NTM5AwcBBwIIMjcxNTQxMDMHAgZMT1pBTk8HAghFU1BJTk9aQQcCBUpFU1VTBwIKMTk0OC0wMS0yMQcABwAG%2F%2F8HAgwxMDM5MDc1MzQ1NDADBwEHAgg0ODcwOTU5MwcCB01FTkRPWkEHAgZMT1pBTk8HAghDQVJPTElOQQcCCjE5NDYtMTEtMDEHAAcABv%2F%2FBwIMMTAzOTA4MzA0NTQwAwcBBwIIMjc5ODUyNjgHAgZIVUFNQU4HAgZQQVVDQVIHAglDTEFSQSBMVVoHAgoxOTc0LTA0LTA0BwAHAAb%2F%2FwcCDDEwMzkxMTYxNDU0MAMHAQcCCDQ4MDQ2MTg5BwIHVkFTUVVFWgcCB0JFQ0VSUkEHAgZBVVJPUkEHAgoxOTQzLTA4LTExBwAHAAb%2F%2FwcCDDEwODQzMDIzNDU0MAMHAQcCCDcwOTEwMzM4BwIHQ0FCUkVSQQcCCU1BTk9TQUxWQQcCC0ZBTlkgTUFERUxJBwIKMTk5NC0wMi0yNgcABwAG%2F%2F8HAgwxMDk5MDY2NzQ1MzkDBwEHAgg0NTk4NDkzOAcCBlJPTUVSTwcCBVZJTExBBwIRQVNVTkNJT04gR0VSRU1JQVMHAgoxOTg5LTA1LTI0BwAHAAb%2F%2FwcCDDExMDE4MTA0NDUzOQMHAQcCCDcxMTIzOTU4BwIGQUNVw5FBBwIGTE9aQU5PBwIOTUlSRVlMSSBZQU5FTEkHAgoxOTk3LTA1LTIwBwAHAAb%2F%2FwcCCzEzNDQwNzc0NTM4AwcBBwIINDUwODIyMTcHAgVDQUxMQQcCB1ZBU1FVRVoHAgpKVUxJQSBST1NBBwIKMTk0Mi0wNi0wMQcABwAG%2F%2F8HAgwxMzQ1MDY3MjQ1MzcDBwEHAggwNzk3MDIzNAcCB1ZFTlRVUkEHAgdNRU5ET1pBBwIFVklMTUEHAgoxOTY4LTA0LTAzBwAHAAb%2F%2FwcCCzEzODA0MDI0NTM4AwcBBwIIODA0MTYwNTUHAgZRVUlST1oHAgdDUlVaQURPBwIHWkVOQUlEQQcCCjE5NDMtMDYtMTIHAAcABv%2F%2FBwIMMTQ4Mjc5Mjk0NTM5AwcBBwIIMTAxNTQxODYHAglCQVJSQU5URVMHAgZST01FUk8HAglBTkEgTUFSSUEHAgoxOTY3LTA4LTE1BwAHAAb%2F%2FwcCCzE1ODQxMTE0NTM4AwcBBwIINDc3NjMzOTEHAgRNT1pBBwIHQU1BTUJBTAcCBkFVUk9SQQcCCjE5NDAtMTAtMDECBVN0YXRlB1EHCAcAAgEHAQIBBwICAQcDAgEHBAIBBwUCAQcGAgEHBwIBBwAHAAcABwACAAUAAACACQIABwAJAgACAAMHBAIABwACAQYREwcAAgEHAAcABwACCFBhZ2VTaXplAwcP&hdidsector=7&hdiddisa=7&hdidred=02&hdidmicrored=01&hdidestablecimiento=&hdidpunto=21&hdfecini=20201123&hdfecfin=20201123&DXScript=1_171%2C1_94%2C1_164%2C1_104%2C1_138%2C1_114%2C1_121%2C1_152&DXCss=0_3598%2C0_3741%2C1_12%2C0_3600%2C0_3745%2C0_3592%2C1_5%2C0_3594",
      "method": "POST",
      "mode": "cors"
    }).then(res => {
      console.log('inicio')
      console.log(res)
      res.body.pipe(dest);
      console.log('termino descargar maestro paciente')

    });;



  }



  async descargarVacCovid() {


    const rpt = fs.createWriteStream(this.RUTA_CARGAR + '/VACUNAS/VACUNACION_COVID.csv');
    await fetch("https://wsalud.minsa.gob.pe/reporteshis/Inmunizaciones/Vacunados.aspx?parametro=127-7-0-0-0-0-01%2f02%2f2021-31%2f03%2f2021", {
      "headers": {
        "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
        "accept-language": "es-ES,es;q=0.9,en;q=0.8",
        "cache-control": "no-cache",
        "content-type": "application/x-www-form-urlencoded",
        "pragma": "no-cache",
        "sec-ch-ua": "\"Chromium\";v=\"88\", \"Google Chrome\";v=\"88\", \";Not A Brand\";v=\"99\"",
        "sec-ch-ua-mobile": "?0",
        "sec-fetch-dest": "iframe",
        "sec-fetch-mode": "navigate",
        "sec-fetch-site": "same-origin",
        "sec-fetch-user": "?1",
        "upgrade-insecure-requests": "1",
        "cookie": "__cfduid=da1827deb7b5803b6297858fedbdd0b1d1611542178; _ga=GA1.1.1150659243.1611596987; _ga_F4HY3YK7EH=GS1.1.1613424152.3.1.1613424202.0; _ga_NWVQ3HSJKS=GS1.1.1613442484.24.1.1613442487.0; ASP.NET_SessionId=2b0yp3fzladgi13b2tig1h02"
      },
      "referrer": "https://wsalud.minsa.gob.pe/reporteshis/Inmunizaciones/Vacunados.aspx?parametro=127-7-0-0-0-0-01/02/2021-28/02/2021",
      "referrerPolicy": "strict-origin-when-cross-origin",
      "body": "__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUJODI1Mjk2MzA1D2QWAgIDD2QWBAIDDw8WAh4EVGV4dAUXVG90YWwgZGUgcmVnaXN0cm9zIDI4ODlkZAIFDzwrABwCAA8WAh4PRGF0YVNvdXJjZUJvdW5kZ2QYPCsABgEFFCsAAmRkZBgBBR5fX0NvbnRyb2xzUmVxdWlyZVBvc3RCYWNrS2V5X18WAQUCZ3beyrZHA%2FHf3zgCu1v%2Bxr6u8mccv%2FLxY5C%2FdOaWKN6qKw%3D%3D&__VIEWSTATEGENERATOR=83655416&__EVENTVALIDATION=%2FwEdAAuB%2BwH1DMFDcphSPL0MxAJn60z594LnSzU4S6PQAbT3rq%2FpNZX4WBzijQTqPezGz2dY%2FqzzKPnlcn%2BXMSt9fV%2BYNnYkKrbN%2FO3%2F80cAQIl6hUr4E8rNR8j1g%2BULBBtNNPuHCckrAtLUuxosmebAadYwj4xXkHQ%2BYn1IHjIKmCBZQdC5fxwZGSiI1vGz9jQ2Ev%2FceTYcQ5kHq6daWfdlKKqcYwT%2BSUyhF5e0clSSWBJgLtry7qtnT1wEt1THtUVXxvkGZLPxgiuHSeixPZSDKbNm&btnExportar=Exportar+a+Excel&gv%24DXSelInput=&gv%24DXKVInput=%5B%5D&gv%24CallbackState=BwIHAgIERGF0YQZ1EAAAAABJCwAASQsAAAAAAAAKAAAAABQAAAAHbnVtX2RvYwdudW1fZG9jBwAACHBhY2llbnRlCHBhY2llbnRlBwAAC2Rlc2NfZ2VuZXJvC2Rlc2NfZ2VuZXJvBwAACGRlc2NfZXRuCGRlc2NfZXRuBwAAEGZlY2hhX25hY2ltaWVudG8QZmVjaGFfbmFjaW1pZW50bwcAABdkZXBhcnRhbWVudG9fcmVzaWRlbmNpYRdkZXBhcnRhbWVudG9fcmVzaWRlbmNpYQcAABRwcm92aW5jaWFfcmVzaWRlbmNpYRRwcm92aW5jaWFfcmVzaWRlbmNpYQcAABNkaXN0cml0b19yZXNpZGVuY2lhE2Rpc3RyaXRvX3Jlc2lkZW5jaWEHAAAJYWN0aXZpZGFkCWFjdGl2aWRhZAcAABBmZWNoYV92YWN1bmFjaW9uEGZlY2hhX3ZhY3VuYWNpb24HAAAGdmFjdW5hBnZhY3VuYQcAAA5kb3Npc19hcGxpY2FkYQ5kb3Npc19hcGxpY2FkYQcAAAl2YWN1bmFkb3IJdmFjdW5hZG9yBwAABERJU0EERElTQQcAAANSRUQDUkVEBwAACE1JQ1JPUkVECE1JQ1JPUkVEBwAAD2VzdGFibGVjaW1pZW50bw9lc3RhYmxlY2ltaWVudG8HAAAcZGVwYXJ0YW1lbnRvX2VzdGFibGVjaW1pZW50bxxkZXBhcnRhbWVudG9fZXN0YWJsZWNpbWllbnRvBwAAGXByb3ZpbmNpYV9lc3RhYmxlY2ltaWVudG8ZcHJvdmluY2lhX2VzdGFibGVjaW1pZW50bwcAABhkaXN0cml0b19lc3RhYmxlY2ltaWVudG8YZGlzdHJpdG9fZXN0YWJsZWNpbWllbnRvBwAAEAAAAA5hYnJldl90aXBvX2RvYw1pZF91YmlnZW9fcmVzEWFuaW9lZGFkX2F0ZW5jaW9uEG1lc2VkYWRfYXRlbmNpb24QZGlhZWRhZF9hdGVuY2lvbgppZF92YWNfcGFjDWNvZGlnb192YWN1bmELZ3J1cG9yaWVzZ28MY29tb3JiaWxpZGFkC2NvbnRhY3RvdGJwCWNvZF91bmljbw5mZWNoYV9yZWdpc3RybwtyZWdpc3RyYWRvcg5jb2RpZ29fbW9kdWxhchBpZF9lc3RyYXRlZ2lhdmFjEGlkX3RpcG9hY3RpdmlkYWQHAAcABwAHAAb%2F%2FwcCCDQwOTA5MTA4BwIbTFVDWSBKRUFOIEpPSE5TT04gU0lOIERBVE9TBwIIRkVNRU5JTk8HAgdNRVNUSVpPBwIKMDEvMDUvMTk4MAcCCUNBSkFNQVJDQQcCCUNBSkFNQVJDQQcCCUNBSkFNQVJDQQcCD1ZBQ1VOQSBDT1ZJRC0xOQcCCjE1LzAyLzIwMjEHAhNWYWN1bmEgY29udHJhIENvdmlkBwIJMcKqIGRvc2lzBwIcTUlSRVogTUVKSUEgTElMWSBERUwgUk9TQVJJTwcCCUNBSkFNQVJDQQcCGk5PIFBFUlRFTkVDRSBBIE5JTkdVTkEgUkVEBwIfTk8gUEVSVEVORUNFIEEgTklOR1VOQSBNSUNST1JFRAcCElJFR0lPTkFMIENBSkFNQVJDQQcCCUNBSkFNQVJDQQcCCUNBSkFNQVJDQQcCCUNBSkFNQVJDQQcABwAG%2F%2F8HAgg0MzU4MDE4NgcCHUNFU0FSIEFMRVhBTkRFUiBMRVpBTUEgQVRPQ0hFBwIJTUFTQ1VMSU5PBwIHTUVTVElaTwcCCjE5LzAxLzE5ODYHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAg9WQUNVTkEgQ09WSUQtMTkHAgoxNS8wMi8yMDIxBwITVmFjdW5hIGNvbnRyYSBDb3ZpZAcCCTHCqiBkb3NpcwcCHE1JUkVaIE1FSklBIExJTFkgREVMIFJPU0FSSU8HAglDQUpBTUFSQ0EHAhpOTyBQRVJURU5FQ0UgQSBOSU5HVU5BIFJFRAcCH05PIFBFUlRFTkVDRSBBIE5JTkdVTkEgTUlDUk9SRUQHAhJSRUdJT05BTCBDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAAcABv%2F%2FBwIINzAyNTYyMDUHAhdQQUxNSVJBIE1BTlRJTExBIFFVSVNQRQcCCEZFTUVOSU5PBwIHTUVTVElaTwcCCjA4LzAxLzE5OTAHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAhNMT1MgQkHDkU9TIERFTCBJTkNBBwIPVkFDVU5BIENPVklELTE5BwIKMTUvMDIvMjAyMQcCE1ZhY3VuYSBjb250cmEgQ292aWQHAgkxwqogZG9zaXMHAhxNSVJFWiBNRUpJQSBMSUxZIERFTCBST1NBUklPBwIJQ0FKQU1BUkNBBwIaTk8gUEVSVEVORUNFIEEgTklOR1VOQSBSRUQHAh9OTyBQRVJURU5FQ0UgQSBOSU5HVU5BIE1JQ1JPUkVEBwISUkVHSU9OQUwgQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwAHAAb%2F%2FwcCCDc2MDY3NzM1BwIcUEFVTEEgQ0FST0xJTkEgU1VBUkVaIEZMT1JFUwcCCEZFTUVOSU5PBwIHTUVTVElaTwcCCjI3LzA4LzE5OTUHAgpMQU1CQVlFUVVFBwIIQ0hJQ0xBWU8HAghDSElDTEFZTwcCD1ZBQ1VOQSBDT1ZJRC0xOQcCCjE1LzAyLzIwMjEHAhNWYWN1bmEgY29udHJhIENvdmlkBwIJMcKqIGRvc2lzBwIcTUlSRVogTUVKSUEgTElMWSBERUwgUk9TQVJJTwcCCUNBSkFNQVJDQQcCGk5PIFBFUlRFTkVDRSBBIE5JTkdVTkEgUkVEBwIfTk8gUEVSVEVORUNFIEEgTklOR1VOQSBNSUNST1JFRAcCElJFR0lPTkFMIENBSkFNQVJDQQcCCUNBSkFNQVJDQQcCCUNBSkFNQVJDQQcCCUNBSkFNQVJDQQcABwAG%2F%2F8HAgg0NzI2MDkzNQcCGk1BUkdPVCBST1NBIEhVQU1BTkkgR0FSQ0lBBwIIRkVNRU5JTk8HAgdNRVNUSVpPBwIKMjEvMDkvMTk5MQcCCUNBSkFNQVJDQQcCBEpBRU4HAgRKQUVOBwIPVkFDVU5BIENPVklELTE5BwIKMTUvMDIvMjAyMQcCE1ZhY3VuYSBjb250cmEgQ292aWQHAgkxwqogZG9zaXMHAh1BTkFZQSBGRVJOQU5ERVogRVZFTFlOIE1BUklOQQcCCUNBSkFNQVJDQQcCGk5PIFBFUlRFTkVDRSBBIE5JTkdVTkEgUkVEBwIfTk8gUEVSVEVORUNFIEEgTklOR1VOQSBNSUNST1JFRAcCCkdSQUwuIEpBRU4HAglDQUpBTUFSQ0EHAgRKQUVOBwIESkFFTgcABwAG%2F%2F8HAggyNzcxOTE3MAcCFERBUklPIEdVRVZBUkEgRkxPUkVTBwIJTUFTQ1VMSU5PBwIHTUVTVElaTwcCCjI2LzEyLzE5NjgHAglDQUpBTUFSQ0EHAgRKQUVOBwIESkFFTgcCD1ZBQ1VOQSBDT1ZJRC0xOQcCCjE1LzAyLzIwMjEHAhNWYWN1bmEgY29udHJhIENvdmlkBwIJMcKqIGRvc2lzBwIYRkVSTkFOREVaIE9SVElaIE1FUkNFREVTBwIJQ0FKQU1BUkNBBwIESkFFTgcCC01PUlJPIFNPTEFSBwILTU9SUk8gU09MQVIHAglDQUpBTUFSQ0EHAgRKQUVOBwIESkFFTgcABwAG%2F%2F8HAgg3MDE5MDU1OAcCHExFWE1JIERFTCBST0NJTyBIVUFNQU4gUkVZRVMHAghGRU1FTklOTwcCB01FU1RJWk8HAgoxMi8xMC8xOTkzBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIPVkFDVU5BIENPVklELTE5BwIKMTUvMDIvMjAyMQcCE1ZhY3VuYSBjb250cmEgQ292aWQHAgkxwqogZG9zaXMHAhxNSVJFWiBNRUpJQSBMSUxZIERFTCBST1NBUklPBwIJQ0FKQU1BUkNBBwIaTk8gUEVSVEVORUNFIEEgTklOR1VOQSBSRUQHAh9OTyBQRVJURU5FQ0UgQSBOSU5HVU5BIE1JQ1JPUkVEBwISUkVHSU9OQUwgQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwAHAAb%2F%2FwcCCDQ3NzczMzYzBwIVQVVST1JBIEhVQU1BTiBIVUFZQU1BBwIIRkVNRU5JTk8HAgdNRVNUSVpPBwIKMDQvMTAvMTk5MgcCCUNBSkFNQVJDQQcCBEpBRU4HAgRKQUVOBwIPVkFDVU5BIENPVklELTE5BwIKMTUvMDIvMjAyMQcCE1ZhY3VuYSBjb250cmEgQ292aWQHAgkxwqogZG9zaXMHAh1BTkFZQSBGRVJOQU5ERVogRVZFTFlOIE1BUklOQQcCCUNBSkFNQVJDQQcCGk5PIFBFUlRFTkVDRSBBIE5JTkdVTkEgUkVEBwIfTk8gUEVSVEVORUNFIEEgTklOR1VOQSBNSUNST1JFRAcCCkdSQUwuIEpBRU4HAglDQUpBTUFSQ0EHAgRKQUVOBwIESkFFTgcABwAG%2F%2F8HAgg0NDE5Mjg5MQcCJEZSQU5TSEVTQ0EgS0FUSEVSSU5BIE1VTkRBQ0EgVklEQVJURQcCCEZFTUVOSU5PBwIHTUVTVElaTwcCCjIwLzAxLzE5ODcHAglDQUpBTUFSQ0EHAgRKQUVOBwIESkFFTgcCD1ZBQ1VOQSBDT1ZJRC0xOQcCCjE1LzAyLzIwMjEHAhNWYWN1bmEgY29udHJhIENvdmlkBwIJMcKqIGRvc2lzBwIdQU5BWUEgRkVSTkFOREVaIEVWRUxZTiBNQVJJTkEHAglDQUpBTUFSQ0EHAhpOTyBQRVJURU5FQ0UgQSBOSU5HVU5BIFJFRAcCH05PIFBFUlRFTkVDRSBBIE5JTkdVTkEgTUlDUk9SRUQHAgpHUkFMLiBKQUVOBwIJQ0FKQU1BUkNBBwIESkFFTgcCBEpBRU4HAAcABv%2F%2FBwIINDQwOTE5NDAHAhRNQVJMRU5ZIFZBU1FVRVogR1VSTwcCCEZFTUVOSU5PBwIHTUVTVElaTwcCCjEzLzAyLzE5ODcHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAg9WQUNVTkEgQ09WSUQtMTkHAgoxNS8wMi8yMDIxBwITVmFjdW5hIGNvbnRyYSBDb3ZpZAcCCTHCqiBkb3NpcwcCHE1JUkVaIE1FSklBIExJTFkgREVMIFJPU0FSSU8HAglDQUpBTUFSQ0EHAhpOTyBQRVJURU5FQ0UgQSBOSU5HVU5BIFJFRAcCH05PIFBFUlRFTkVDRSBBIE5JTkdVTkEgTUlDUk9SRUQHAhJSRUdJT05BTCBDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0ECBVN0YXRlB40HFwcAAgEHAAIBBwECAQcCAgEHAwIBBwQCAQcFAgEHBgIBBwcCAQcBAgEHAAIBBwECAQcCAgEHAwIBBwQCAQcCAgEHAAIBBwICAQcBAgEHAwIBBwQCAQcFAgEHBgIBBwAHAAcABwACAAUAAACACQIABwAJAgACAAMHBAIABwACAQZJCwcAAgEHAAcABwA%3D&hdpidactividad=127&hdpiddisa=7&hdpidred=0&hdpidmicrored=0&hdpidestablecimiento=0&hdprandoedad=0&hdpfecini=01%2F02%2F2021&hdpfecfin=28%2F02%2F2021&DXScript=1_171%2C1_94%2C1_164%2C1_104%2C1_138%2C1_114%2C1_121%2C1_152&DXCss=0_3598%2C0_3741%2C1_12%2C0_3600%2C0_3745%2C0_3592%2C1_5%2C0_3594",
      "method": "POST",
      "mode": "cors"
    }).then(res => {


      res.body.pipe(rpt);
      console.log('termino')
      return 1

    });
  }


  descargarVacCovidPeriodo(anio: number, mes: number) {
    const rpt = fs.createWriteStream(this.RUTA_CARGAR + '/vacu.csv');
    let FECHA_INICIO_PERIODO = new Date()

    FECHA_INICIO_PERIODO.setUTCDate(1)
    FECHA_INICIO_PERIODO.setUTCMonth(mes - 1)
    FECHA_INICIO_PERIODO.setUTCFullYear(anio)


    let FECHA_FIN_PERIODO = new Date(FECHA_INICIO_PERIODO.getFullYear(), FECHA_INICIO_PERIODO.getMonth() + 1, 0)





    let FECHA_INICIO_PERIODO_FORMAT = FECHA_INICIO_PERIODO.getUTCFullYear() * 10000 + (FECHA_INICIO_PERIODO.getUTCMonth() + 1) * 100 + FECHA_INICIO_PERIODO.getUTCDate()
    let FECHA_FIN_PERIODO_FORMAT = FECHA_FIN_PERIODO.getUTCFullYear() * 10000 + (FECHA_FIN_PERIODO.getUTCMonth() + 1) * 100 + FECHA_FIN_PERIODO.getUTCDate()

    FECHA_FIN_PERIODO.setUTCFullYear(anio)

    if (mes == (new Date()).getMonth() + 1 && anio == (new Date()).getFullYear()) {


      FECHA_FIN_PERIODO = new Date()
      FECHA_FIN_PERIODO.setUTCDate(FECHA_FIN_PERIODO.getUTCDate() - 1)

      let FECHA_INICIO_PERIODO_FORMAT = FECHA_INICIO_PERIODO.getUTCFullYear() * 10000 + (FECHA_INICIO_PERIODO.getUTCMonth() + 1) * 100 + FECHA_INICIO_PERIODO.getUTCDate()
      let FECHA_FIN_PERIODO_FORMAT = FECHA_FIN_PERIODO.getUTCFullYear() * 10000 + (FECHA_FIN_PERIODO.getUTCMonth() + 1) * 100 + FECHA_FIN_PERIODO.getUTCDate()

    }

    console.log(FECHA_INICIO_PERIODO_FORMAT + '-' + FECHA_FIN_PERIODO_FORMAT)


    fetch("https://wsalud.minsa.gob.pe/reporteshis/Inmunizaciones/Vacunados.aspx?parametro=127-7-0-0-0-0-01%2f02%2f2021-28%2f02%2f2021", {
  "headers": {
    "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
    "accept-language": "es-ES,es;q=0.9,en;q=0.8",
    "cache-control": "no-cache",
    "content-type": "application/x-www-form-urlencoded",
    "pragma": "no-cache",
    "sec-ch-ua": "\"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\"",
    "sec-ch-ua-mobile": "?0",
    "sec-fetch-dest": "iframe",
    "sec-fetch-mode": "navigate",
    "sec-fetch-site": "same-origin",
    "sec-fetch-user": "?1",
    "upgrade-insecure-requests": "1",
    "cookie": "_ga_F4HY3YK7EH=GS1.1.1613481795.4.0.1613481795.0; _ga_LEDF527D3S=GS1.1.1615149485.2.0.1615149485.0; _ga_NWVQ3HSJKS=GS1.1.1616246531.42.0.1616246531.0; __cfduid=dd5bdc617b217e464fa82561c266ee95d1616770022; _ga_T513LTCYK1=GS1.1.1617765779.30.0.1617765779.0; _ga=GA1.3.1150659243.1611596987; ASP.NET_SessionId=c110eluhisgs3dbgbefqkyfq"
  },
  "referrer": "https://wsalud.minsa.gob.pe/reporteshis/Inmunizaciones/Vacunados.aspx?parametro=127-7-0-0-0-0-01/02/2021-28/02/2021",
  "referrerPolicy": "strict-origin-when-cross-origin",
  "body": "__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUJODI1Mjk2MzA1D2QWAgIDD2QWBAIDDw8WAh4EVGV4dAUXVG90YWwgZGUgcmVnaXN0cm9zIDkzMTNkZAIFDzwrABwCAA8WAh4PRGF0YVNvdXJjZUJvdW5kZ2QYPCsABgEFFCsAAmRkZBgBBR5fX0NvbnRyb2xzUmVxdWlyZVBvc3RCYWNrS2V5X18WAQUCZ3bqJcSjLEGqokNr%2FLTPfjTkDEzkhhgwyHzdU0kuAgUhaA%3D%3D&__VIEWSTATEGENERATOR=83655416&__EVENTVALIDATION=%2FwEdAAvah%2BfpfYdLyNVPT7I%2B5WoF60z594LnSzU4S6PQAbT3rq%2FpNZX4WBzijQTqPezGz2dY%2FqzzKPnlcn%2BXMSt9fV%2BYNnYkKrbN%2FO3%2F80cAQIl6hUr4E8rNR8j1g%2BULBBtNNPuHCckrAtLUuxosmebAadYwj4xXkHQ%2BYn1IHjIKmCBZQdC5fxwZGSiI1vGz9jQ2Ev%2FceTYcQ5kHq6daWfdlKKqcYwT%2BSUyhF5e0clSSWBJgLh1kTWkNhpvTdvJJt0Bag%2Be8JT3sjAH9TwU1voteCfqu&btnExportar=Exportar+a+Excel&gv%24DXSelInput=&gv%24DXKVInput=%5B%5D&gv%24CallbackState=BwIHAgIERGF0YQacDwAAAABhJAAAYSQAAAAAAAAKAAAAABQAAAAHbnVtX2RvYwdudW1fZG9jBwAACHBhY2llbnRlCHBhY2llbnRlBwAAC2Rlc2NfZ2VuZXJvC2Rlc2NfZ2VuZXJvBwAACGRlc2NfZXRuCGRlc2NfZXRuBwAAEGZlY2hhX25hY2ltaWVudG8QZmVjaGFfbmFjaW1pZW50bwcAABdkZXBhcnRhbWVudG9fcmVzaWRlbmNpYRdkZXBhcnRhbWVudG9fcmVzaWRlbmNpYQcAABRwcm92aW5jaWFfcmVzaWRlbmNpYRRwcm92aW5jaWFfcmVzaWRlbmNpYQcAABNkaXN0cml0b19yZXNpZGVuY2lhE2Rpc3RyaXRvX3Jlc2lkZW5jaWEHAAAJYWN0aXZpZGFkCWFjdGl2aWRhZAcAABBmZWNoYV92YWN1bmFjaW9uEGZlY2hhX3ZhY3VuYWNpb24HAAAGdmFjdW5hBnZhY3VuYQcAAA5kb3Npc19hcGxpY2FkYQ5kb3Npc19hcGxpY2FkYQcAAAl2YWN1bmFkb3IJdmFjdW5hZG9yBwAABERJU0EERElTQQcAAANSRUQDUkVEBwAACE1JQ1JPUkVECE1JQ1JPUkVEBwAAD2VzdGFibGVjaW1pZW50bw9lc3RhYmxlY2ltaWVudG8HAAAcZGVwYXJ0YW1lbnRvX2VzdGFibGVjaW1pZW50bxxkZXBhcnRhbWVudG9fZXN0YWJsZWNpbWllbnRvBwAAGXByb3ZpbmNpYV9lc3RhYmxlY2ltaWVudG8ZcHJvdmluY2lhX2VzdGFibGVjaW1pZW50bwcAABhkaXN0cml0b19lc3RhYmxlY2ltaWVudG8YZGlzdHJpdG9fZXN0YWJsZWNpbWllbnRvBwAAEgAAAA5hYnJldl90aXBvX2RvYw1pZF91YmlnZW9fcmVzEWFuaW9lZGFkX2F0ZW5jaW9uEG1lc2VkYWRfYXRlbmNpb24QZGlhZWRhZF9hdGVuY2lvbgppZF92YWNfcGFjDWNvZGlnb192YWN1bmELZ3J1cG9yaWVzZ28MY29tb3JiaWxpZGFkC2NvbnRhY3RvdGJwCWNvZF91bmljbw5mZWNoYV9yZWdpc3RybwtyZWdpc3RyYWRvcg5jb2RpZ29fbW9kdWxhchBpZF9lc3RyYXRlZ2lhdmFjEGlkX3RpcG9hY3RpdmlkYWQLTG90ZV9WYWN1bmEKRmFicmljYW50ZQcABwAHAAcABv%2F%2FBwIINzE4MzEzNzgHAiFGSU9SRUxMQSBKQUhBWVJBIFFVRVpBREEgVEFSQVpPTkEHAghGRU1FTklOTwcCB01FU1RJWk8HAgoxMS8xMi8xOTkyBwIETElNQQcCBkhVQVVSQQcCBkhVQVVSQQcCD1ZBQ1VOQSBDT1ZJRC0xOQcCCjI4LzAyLzIwMjEHAhNWYWN1bmEgY29udHJhIENvdmlkBwIJMcKqIGRvc2lzBwIVQ0FTVFJFSk9OIENBTFVBIE5FTExZBwIJQ0FKQU1BUkNBBwIJQ0FKQUJBTUJBBwILTExVQ0hVQkFNQkEHAgtMTFVDSFVCQU1CQQcCCUNBSkFNQVJDQQcCCUNBSkFCQU1CQQcCCVNJVEFDT0NIQQcABwAG%2F%2F8HAgg3MDU4NDY1MAcCGUNFQ0lMSUEgTUlDSEVMIExFT04gTVU%2FT1oHAghGRU1FTklOTwcCB01FU1RJWk8HAgoxOS8xMi8xOTk1BwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIPVkFDVU5BIENPVklELTE5BwIKMjgvMDIvMjAyMQcCE1ZhY3VuYSBjb250cmEgQ292aWQHAgkxwqogZG9zaXMHAiBNSVJBTkRBIFNBTkNIRVogSE9SVEVOQ0lBIExJU1NFVAcCCUNBSkFNQVJDQQcCCUNBSkFNQVJDQQcCDU1BR05BIFZBTExFSk8HAg1NQUdOQSBWQUxMRUpPBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwAHAAb%2F%2FwcCCDQ3OTI4NTU4BwIcQU5BIFBBVUxBIFNBTEFWRVJSWSBFTlJJUVVFWgcCCEZFTUVOSU5PBwIHTUVTVElaTwcCCjAxLzA4LzE5OTMHAgtMQSBMSUJFUlRBRAcCCFRSVUpJTExPBwIIVFJVSklMTE8HAg9WQUNVTkEgQ09WSUQtMTkHAgoyOC8wMi8yMDIxBwITVmFjdW5hIGNvbnRyYSBDb3ZpZAcCCTHCqiBkb3NpcwcCJ1ZJTExPU0xBREEgTU9OVEVORUdSTyBJTkRJUkEgREVMIENBUk1FTgcCCUNBSkFNQVJDQQcCCUNBSkFNQVJDQQcCCU1BR0RBTEVOQQcCCU1BR0RBTEVOQQcCCUNBSkFNQVJDQQcCCUNBSkFNQVJDQQcCCU1BR0RBTEVOQQcABwAG%2F%2F8HAgg0Nzk1MTU0MwcCG0tBUklOIEVESVQgUEFMT01JTk8gVkVOVFVSQQcCCEZFTUVOSU5PBwIHTUVTVElaTwcCCjMxLzAzLzE5OTMHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAg9WQUNVTkEgQ09WSUQtMTkHAgoyOC8wMi8yMDIxBwITVmFjdW5hIGNvbnRyYSBDb3ZpZAcCCTHCqiBkb3NpcwcCIE1JUkFOREEgU0FOQ0hFWiBIT1JURU5DSUEgTElTU0VUBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwINTUFHTkEgVkFMTEVKTwcCDU1BR05BIFZBTExFSk8HAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAAcABv%2F%2FBwIINDcxNTIxMjUHAh9KSE9OQVRBTiBMRU9OQVJETyBDSEFWRVogTUVESU5BBwIJTUFTQ1VMSU5PBwIHTUVTVElaTwcCCjA3LzA2LzE5OTEHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAg9WQUNVTkEgQ09WSUQtMTkHAgoyOC8wMi8yMDIxBwITVmFjdW5hIGNvbnRyYSBDb3ZpZAcCCTHCqiBkb3NpcwcCIE1JUkFOREEgU0FOQ0hFWiBIT1JURU5DSUEgTElTU0VUBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwINTUFHTkEgVkFMTEVKTwcCDU1BR05BIFZBTExFSk8HAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAAcABv%2F%2FBwIINDcxMDQ3MjcHAhZWRUlNRVIgVkFTUVVFWiBHVUVWQVJBBwIJTUFTQ1VMSU5PBwIHTUVTVElaTwcCCjEyLzAxLzE5OTIHAglDQUpBTUFSQ0EHAgVDSE9UQQcCBUNIT1RBBwIPVkFDVU5BIENPVklELTE5BwIKMjgvMDIvMjAyMQcCE1ZhY3VuYSBjb250cmEgQ292aWQHAgkxwqogZG9zaXMHAidWSUxMT1NMQURBIE1PTlRFTkVHUk8gSU5ESVJBIERFTCBDQVJNRU4HAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAglNQUdEQUxFTkEHAglNQUdEQUxFTkEHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAglNQUdEQUxFTkEHAAcABv%2F%2FBwIINDY5NDY4MzAHAiFTVEVQSEFOWSBQUklTQ0lMQSBQUklFVE8gRVNQSU5PWkEHAghGRU1FTklOTwcCB01FU1RJWk8HAgoxOS8wOS8xOTkxBwILTEEgTElCRVJUQUQHAgZDSEVQRU4HAgZDSEVQRU4HAg9WQUNVTkEgQ09WSUQtMTkHAgoyOC8wMi8yMDIxBwITVmFjdW5hIGNvbnRyYSBDb3ZpZAcCCTHCqiBkb3NpcwcCIE1JUkFOREEgU0FOQ0hFWiBIT1JURU5DSUEgTElTU0VUBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwINTUFHTkEgVkFMTEVKTwcCDU1BR05BIFZBTExFSk8HAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAglDQUpBTUFSQ0EHAAcABv%2F%2FBwIINDY1MzkyMzYHAhlST1NBIE1FUkNFREVTIFVHQVogU0FOR0FZBwIIRkVNRU5JTk8HAgdNRVNUSVpPBwIKMjQvMDkvMTk5MAcCCUNBSkFNQVJDQQcCCUNBSkFNQVJDQQcCCU1BR0RBTEVOQQcCD1ZBQ1VOQSBDT1ZJRC0xOQcCCjI4LzAyLzIwMjEHAhNWYWN1bmEgY29udHJhIENvdmlkBwIJMcKqIGRvc2lzBwInVklMTE9TTEFEQSBNT05URU5FR1JPIElORElSQSBERUwgQ0FSTUVOBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIJTUFHREFMRU5BBwIJTUFHREFMRU5BBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIJTUFHREFMRU5BBwAHAAb%2F%2FwcCCDQ1OTIzMjQ4BwIaTUFSVUpBIENVU1FVSVNJQkFOIEFTRU5DSU8HAghGRU1FTklOTwcCB01FU1RJWk8HAgoyMC8wOS8xOTg5BwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIPVkFDVU5BIENPVklELTE5BwIKMjgvMDIvMjAyMQcCE1ZhY3VuYSBjb250cmEgQ292aWQHAgkxwqogZG9zaXMHAiBNSVJBTkRBIFNBTkNIRVogSE9SVEVOQ0lBIExJU1NFVAcCCUNBSkFNQVJDQQcCCUNBSkFNQVJDQQcCDU1BR05BIFZBTExFSk8HAg1NQUdOQSBWQUxMRUpPBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwIJQ0FKQU1BUkNBBwAHAAb%2F%2FwcCCDQ1MjI4Mjk1BwIWTFVaIE1BUklBIFJVSVogU0FMSU5BUwcCCEZFTUVOSU5PBwIHTUVTVElaTwcCCjEwLzAxLzE5ODgHAgtMQSBMSUJFUlRBRAcCCFRSVUpJTExPBwILRUwgUE9SVkVOSVIHAg9WQUNVTkEgQ09WSUQtMTkHAgoyOC8wMi8yMDIxBwITVmFjdW5hIGNvbnRyYSBDb3ZpZAcCCTHCqiBkb3NpcwcCJ1ZJTExPU0xBREEgTU9OVEVORUdSTyBJTkRJUkEgREVMIENBUk1FTgcCCUNBSkFNQVJDQQcCCUNBSkFNQVJDQQcCCU1BR0RBTEVOQQcCCU1BR0RBTEVOQQcCCUNBSkFNQVJDQQcCCUNBSkFNQVJDQQcCCU1BR0RBTEVOQQIFU3RhdGUHjQcXBwACAQcAAgEHAQIBBwICAQcDAgEHBAIBBwUCAQcGAgEHBwIBBwECAQcAAgEHAQIBBwICAQcDAgEHBAIBBwICAQcAAgEHAgIBBwECAQcDAgEHBAIBBwUCAQcGAgEHAAcABwAHAAIABQAAAIAJAgAHAAkCAAIAAwcEAgAHAAIBBmEkBwACAQcABwAHAA%3D%3D&hdpidactividad=127&hdpiddisa=7&hdpidred=0&hdpidmicrored=0&hdpidestablecimiento=0&hdprandoedad=0&hdpfecini=01%2F02%2F2021&hdpfecfin=28%2F02%2F2021&DXScript=1_171%2C1_94%2C1_164%2C1_104%2C1_138%2C1_114%2C1_121%2C1_152&DXCss=0_3598%2C0_3741%2C1_12%2C0_3600%2C0_3745%2C0_3592%2C1_5%2C0_3594",
  "method": "POST",
  "mode": "cors"
}).then(res => {


  res.body.pipe(rpt);
  console.log('res')
  return 1

});




  }



  async VER() {


    
    let resp = await fetch("https://websalud.minsa.gob.pe/hisminsa/security", {
      "headers": {
        "accept": "*/*",
        "accept-language": "es-ES,es;q=0.9,en;q=0.8",
        "cache-control": "no-cache",
        "content-type": "application/x-www-form-urlencoded; charset=UTF-8",
        "pragma": "no-cache",
        "sec-ch-ua": "\"Chromium\";v=\"88\", \"Google Chrome\";v=\"88\", \";Not A Brand\";v=\"99\"",
        "sec-ch-ua-mobile": "?0",
        "sec-fetch-dest": "empty",
        "sec-fetch-mode": "cors",
        "sec-fetch-site": "same-origin",
        "x-requested-with": "XMLHttpRequest"
      },
      "referrer": "https://websalud.minsa.gob.pe/hisminsa/",
      "referrerPolicy": "strict-origin-when-cross-origin",
      "body": "C=USER&S=GETBYIDANDPERXEESS&iduser=33637&idpersonal=28652484&idperxeess=714250",
      "method": "POST",
      "mode": "cors",
      "credentials": "include"
    }).then(res => {
      console.log(res.body)
      return res
    });

    return resp
  }


  async consultarDni(num_doc:string){



   let resp=await fetch("https://websalud.minsa.gob.pe/appInmunizacion/view/consultas/consultavacunados/Consultas", {
    "headers": {
      "accept": "application/json, text/javascript, */*; q=0.01",
      "accept-language": "es-ES,es;q=0.9,en;q=0.8",
      "cache-control": "no-cache",
      "content-type": "application/x-www-form-urlencoded; charset=UTF-8",
      "pragma": "no-cache",
      "sec-ch-ua": "\" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\"",
      "sec-ch-ua-mobile": "?0",
      "sec-fetch-dest": "empty",
      "sec-fetch-mode": "cors",
      "sec-fetch-site": "same-origin",
    
    },
    "referrer": "https://websalud.minsa.gob.pe/appInmunizacion/view/consultas/consultavacunados/consultavacunados.jsp",
    "referrerPolicy": "strict-origin-when-cross-origin",
    "body": "accion=QRY2&numpag=&col=per.num_doc&txt=26947751&rangoedad=&fechainicio=07%2F02%2F2021&fechafin=31%2F12%2F2021&idactividad=127&iddiresa=7&idred=&idestablecimiento=",
    "method": "POST",
    "mode": "cors",
    "credentials": "include"
  }).then((respuesta)=>{
console.log(respuesta)
});

  }




  devolverVacunaCovidDia(anio:string,mes:string,dia:string){

    const rpt = fs.createWriteStream(this.RUTA_CARGAR + '/vacu_'+anio+'_'+mes+'_'+dia+'.csv');

    fetch("https://wsalud.minsa.gob.pe/reporteshis/Inmunizaciones/Vacunados.aspx?parametro=127-7-0-0-0-0-06%2f05%2f2021-06%2f05%2f2021", {
  "headers": {
    "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
    "accept-language": "es-ES,es;q=0.9,en;q=0.8",
    "cache-control": "no-cache",
    "content-type": "application/x-www-form-urlencoded",
    "pragma": "no-cache",
    "sec-ch-ua": "\" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\"",
    "sec-ch-ua-mobile": "?0",
    "sec-fetch-dest": "iframe",
    "sec-fetch-mode": "navigate",
    "sec-fetch-site": "same-origin",
    "sec-fetch-user": "?1",
    "upgrade-insecure-requests": "1"
  },
  "referrer": "https://wsalud.minsa.gob.pe/reporteshis/Inmunizaciones/Vacunados.aspx?parametro=127-7-0-0-0-0-06/05/2021-06/05/2021",
  "referrerPolicy": "strict-origin-when-cross-origin",
  "body": "__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUJODI1Mjk2MzA1D2QWAgIDD2QWBAIDDw8WAh4EVGV4dAUWVG90YWwgZGUgcmVnaXN0cm9zIDE0N2RkAgUPPCsAHAIADxYCHg9EYXRhU291cmNlQm91bmRnZBg8KwAGAQUUKwACZGRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQJndn2CSH1z9Wcla9zxuxCd8ryQLPofwjWuHQ8N3KGeoQYa&__VIEWSTATEGENERATOR=83655416&__EVENTVALIDATION=%2FwEdAAvy7eHpzUd2nIrBsx02ypph60z594LnSzU4S6PQAbT3rq%2FpNZX4WBzijQTqPezGz2dY%2FqzzKPnlcn%2BXMSt9fV%2BYNnYkKrbN%2FO3%2F80cAQIl6hUr4E8rNR8j1g%2BULBBtNNPuHCckrAtLUuxosmebAadYwj4xXkHQ%2BYn1IHjIKmCBZQdC5fxwZGSiI1vGz9jQ2Ev%2FceTYcQ5kHq6daWfdlKKqcYwT%2BSUyhF5e0clSSWBJgLs5rsgtQ84H062NDNJQgnnb9C2%2FQIvaS4WzG5rgGdELD&btnExportar=Exportar+a+Excel&gv%24DXSelInput=&gv%24DXKVInput=%5B%5D&gv%24CallbackState=BwIHAgIERGF0YQZkDwAAAACTAAAAkwAAAAAAAAAKAAAAABQAAAAHbnVtX2RvYwdudW1fZG9jBwAACHBhY2llbnRlCHBhY2llbnRlBwAAC2Rlc2NfZ2VuZXJvC2Rlc2NfZ2VuZXJvBwAACGRlc2NfZXRuCGRlc2NfZXRuBwAAEGZlY2hhX25hY2ltaWVudG8QZmVjaGFfbmFjaW1pZW50bwcAABdkZXBhcnRhbWVudG9fcmVzaWRlbmNpYRdkZXBhcnRhbWVudG9fcmVzaWRlbmNpYQcAABRwcm92aW5jaWFfcmVzaWRlbmNpYRRwcm92aW5jaWFfcmVzaWRlbmNpYQcAABNkaXN0cml0b19yZXNpZGVuY2lhE2Rpc3RyaXRvX3Jlc2lkZW5jaWEHAAAJYWN0aXZpZGFkCWFjdGl2aWRhZAcAABBmZWNoYV92YWN1bmFjaW9uEGZlY2hhX3ZhY3VuYWNpb24HAAAGdmFjdW5hBnZhY3VuYQcAAA5kb3Npc19hcGxpY2FkYQ5kb3Npc19hcGxpY2FkYQcAAAl2YWN1bmFkb3IJdmFjdW5hZG9yBwAABERJU0EERElTQQcAAANSRUQDUkVEBwAACE1JQ1JPUkVECE1JQ1JPUkVEBwAAD2VzdGFibGVjaW1pZW50bw9lc3RhYmxlY2ltaWVudG8HAAAcZGVwYXJ0YW1lbnRvX2VzdGFibGVjaW1pZW50bxxkZXBhcnRhbWVudG9fZXN0YWJsZWNpbWllbnRvBwAAGXByb3ZpbmNpYV9lc3RhYmxlY2ltaWVudG8ZcHJvdmluY2lhX2VzdGFibGVjaW1pZW50bwcAABhkaXN0cml0b19lc3RhYmxlY2ltaWVudG8YZGlzdHJpdG9fZXN0YWJsZWNpbWllbnRvBwAAEgAAAA5hYnJldl90aXBvX2RvYw1pZF91YmlnZW9fcmVzEWFuaW9lZGFkX2F0ZW5jaW9uEG1lc2VkYWRfYXRlbmNpb24QZGlhZWRhZF9hdGVuY2lvbgppZF92YWNfcGFjDWNvZGlnb192YWN1bmELZ3J1cG9yaWVzZ28MY29tb3JiaWxpZGFkC2NvbnRhY3RvdGJwCWNvZF91bmljbw5mZWNoYV9yZWdpc3RybwtyZWdpc3RyYWRvcg5jb2RpZ29fbW9kdWxhchBpZF9lc3RyYXRlZ2lhdmFjEGlkX3RpcG9hY3RpdmlkYWQLTG90ZV9WYWN1bmEKRmFicmljYW50ZQcABwAHAAcABv%2F%2FBwIINDg1MTY3MzgHAiBNQVJJQSBBVVJFTElBIEJVU1RBTUFOVEUgUk9EUklHTwcCCEZFTUVOSU5PBwIHTUVTVElaTwcCCjAxLzAyLzE5NDIHAglDQUpBTUFSQ0EHAgVDSE9UQQcCBUNIT1RBBwIPVkFDVU5BIENPVklELTE5BwIKMDYvMDUvMjAyMQcCE1ZhY3VuYSBjb250cmEgQ292aWQHAgkxwqogZG9zaXMHAhlERUxHQURPIFJPSkFTIEpVQU4gQ0FSTE9TBwIJQ0FKQU1BUkNBBwIaTk8gUEVSVEVORUNFIEEgTklOR1VOQSBSRUQHAh9OTyBQRVJURU5FQ0UgQSBOSU5HVU5BIE1JQ1JPUkVEBwITQ0VOVFJPIE1FRElDTyBDSE9UQQcCCUNBSkFNQVJDQQcCBUNIT1RBBwIFQ0hPVEEHAAcABv%2F%2FBwIIMjczNjQwMjcHAh1NSUxMQU4gVklURUxJTyBDSEFWRVogVkFTUVVFWgcCCU1BU0NVTElOTwcCB01FU1RJWk8HAgoyMy8wMS8xOTQ5BwIJQ0FKQU1BUkNBBwIFQ0hPVEEHAgVDSE9UQQcCD1ZBQ1VOQSBDT1ZJRC0xOQcCCjA2LzA1LzIwMjEHAhNWYWN1bmEgY29udHJhIENvdmlkBwIJMcKqIGRvc2lzBwIZREVMR0FETyBST0pBUyBKVUFOIENBUkxPUwcCCUNBSkFNQVJDQQcCGk5PIFBFUlRFTkVDRSBBIE5JTkdVTkEgUkVEBwIfTk8gUEVSVEVORUNFIEEgTklOR1VOQSBNSUNST1JFRAcCE0NFTlRSTyBNRURJQ08gQ0hPVEEHAglDQUpBTUFSQ0EHAgVDSE9UQQcCBUNIT1RBBwAHAAb%2F%2FwcCCDgwMzY5NTE4BwIaRkxPUiBNQVJJTkEgTlXDkUVaIEdVRVZBUkEHAghGRU1FTklOTwcCB01FU1RJWk8HAgowOS8xMS8xOTQyBwIJQ0FKQU1BUkNBBwIFQ0hPVEEHAgVDSE9UQQcCD1ZBQ1VOQSBDT1ZJRC0xOQcCCjA2LzA1LzIwMjEHAhNWYWN1bmEgY29udHJhIENvdmlkBwIJMcKqIGRvc2lzBwIZREVMR0FETyBST0pBUyBKVUFOIENBUkxPUwcCCUNBSkFNQVJDQQcCGk5PIFBFUlRFTkVDRSBBIE5JTkdVTkEgUkVEBwIfTk8gUEVSVEVORUNFIEEgTklOR1VOQSBNSUNST1JFRAcCE0NFTlRSTyBNRURJQ08gQ0hPVEEHAglDQUpBTUFSQ0EHAgVDSE9UQQcCBUNIT1RBBwAHAAb%2F%2FwcCCDgwMTg4MjcwBwIUUEFVTEEgUVVJU1BFIFNBTEFaQVIHAghGRU1FTklOTwcCB01FU1RJWk8HAgoxNS8wMS8xOTQxBwIJQ0FKQU1BUkNBBwIHQ1VURVJWTwcCB0NVVEVSVk8HAg9WQUNVTkEgQ09WSUQtMTkHAgowNi8wNS8yMDIxBwITVmFjdW5hIGNvbnRyYSBDb3ZpZAcCCTHCqiBkb3NpcwcCFlJPSkFTIEZFUk5BTkRFWiBMQVpBUk8HAglDQUpBTUFSQ0EHAgdDVVRFUlZPBwINTlVFVk8gT1JJRU5URQcCDU5VRVZPIE9SSUVOVEUHAglDQUpBTUFSQ0EHAgdDVVRFUlZPBwIHQ1VURVJWTwcABwAG%2F%2F8HAgg4MDE4ODM0NwcCFk9MSU5EQSBIRVJSRVJBIEdVRVZBUkEHAghGRU1FTklOTwcCB01FU1RJWk8HAgoyOC8xMi8xOTM2BwIJQ0FKQU1BUkNBBwIHQ1VURVJWTwcCB0NVVEVSVk8HAg9WQUNVTkEgQ09WSUQtMTkHAgowNi8wNS8yMDIxBwITVmFjdW5hIGNvbnRyYSBDb3ZpZAcCCTHCqiBkb3NpcwcCF1BFUkVaIEFHSVAgRElBTkEgWlVOQUxZBwIJQ0FKQU1BUkNBBwIHQ1VURVJWTwcCDU5VRVZPIE9SSUVOVEUHAg1OVUVWTyBPUklFTlRFBwIJQ0FKQU1BUkNBBwIHQ1VURVJWTwcCB0NVVEVSVk8HAAcABv%2F%2FBwIIODAxNzAyMzgHAh1NQVJJQSBHUkVHT1JJQSBQRVJFWiBSRUdBTEFETwcCCEZFTUVOSU5PBwIHTUVTVElaTwcCCjA1LzA2LzE5MzQHAglDQUpBTUFSQ0EHAgdDVVRFUlZPBwIHQ1VURVJWTwcCD1ZBQ1VOQSBDT1ZJRC0xOQcCCjA2LzA1LzIwMjEHAhNWYWN1bmEgY29udHJhIENvdmlkBwIJMcKqIGRvc2lzBwIWUk9KQVMgRkVSTkFOREVaIExBWkFSTwcCCUNBSkFNQVJDQQcCB0NVVEVSVk8HAg1OVUVWTyBPUklFTlRFBwINTlVFVk8gT1JJRU5URQcCCUNBSkFNQVJDQQcCB0NVVEVSVk8HAgdDVVRFUlZPBwAHAAb%2F%2FwcCCDQ4NjgxMjUyBwIgTUFSSUEgTUVSRU5DSUFOQSBOQVZBUlJPIFFVSU5UT1MHAghGRU1FTklOTwcCB01FU1RJWk8HAgoxNS8wMy8xOTM4BwIJQ0FKQU1BUkNBBwIHQ1VURVJWTwcCB0NVVEVSVk8HAg9WQUNVTkEgQ09WSUQtMTkHAgowNi8wNS8yMDIxBwITVmFjdW5hIGNvbnRyYSBDb3ZpZAcCCTHCqiBkb3NpcwcCFlJPSkFTIEZFUk5BTkRFWiBMQVpBUk8HAglDQUpBTUFSQ0EHAgdDVVRFUlZPBwINTlVFVk8gT1JJRU5URQcCDU5VRVZPIE9SSUVOVEUHAglDQUpBTUFSQ0EHAgdDVVRFUlZPBwIHQ1VURVJWTwcABwAG%2F%2F8HAgg0ODgyMDE0NQcCFkVNSUxJQSBHVUVWQVJBIFNPQkVST04HAghGRU1FTklOTwcCB01FU1RJWk8HAgoxNS8xMS8xOTMzBwIJQ0FKQU1BUkNBBwIHQ1VURVJWTwcCB0NVVEVSVk8HAg9WQUNVTkEgQ09WSUQtMTkHAgowNi8wNS8yMDIxBwITVmFjdW5hIGNvbnRyYSBDb3ZpZAcCCTHCqiBkb3NpcwcCFlJPSkFTIEZFUk5BTkRFWiBMQVpBUk8HAglDQUpBTUFSQ0EHAgdDVVRFUlZPBwINTlVFVk8gT1JJRU5URQcCDU5VRVZPIE9SSUVOVEUHAglDQUpBTUFSQ0EHAgdDVVRFUlZPBwIHQ1VURVJWTwcABwAG%2F%2F8HAgg0ODIzMDc5MAcCF1NBTE9NT04gRElBWiBBTFRBTUlSQU5PBwIJTUFTQ1VMSU5PBwIHTUVTVElaTwcCCjI1LzA1LzE5MzgHAglDQUpBTUFSQ0EHAgdDVVRFUlZPBwIHQ1VURVJWTwcCD1ZBQ1VOQSBDT1ZJRC0xOQcCCjA2LzA1LzIwMjEHAhNWYWN1bmEgY29udHJhIENvdmlkBwIJMcKqIGRvc2lzBwIXUEVSRVogQUdJUCBESUFOQSBaVU5BTFkHAglDQUpBTUFSQ0EHAgdDVVRFUlZPBwINTlVFVk8gT1JJRU5URQcCDU5VRVZPIE9SSUVOVEUHAglDQUpBTUFSQ0EHAgdDVVRFUlZPBwIHQ1VURVJWTwcABwAG%2F%2F8HAgg0ODIzMDc5MQcCGEdSRUdPUklPIERJQVogQUxUQU1JUkFOTwcCCU1BU0NVTElOTwcCB01FU1RJWk8HAgoyMy8wOC8xOTM2BwIJQ0FKQU1BUkNBBwIHQ1VURVJWTwcCB0NVVEVSVk8HAg9WQUNVTkEgQ09WSUQtMTkHAgowNi8wNS8yMDIxBwITVmFjdW5hIGNvbnRyYSBDb3ZpZAcCCTHCqiBkb3NpcwcCF1BFUkVaIEFHSVAgRElBTkEgWlVOQUxZBwIJQ0FKQU1BUkNBBwIHQ1VURVJWTwcCDU5VRVZPIE9SSUVOVEUHAg1OVUVWTyBPUklFTlRFBwIJQ0FKQU1BUkNBBwIHQ1VURVJWTwcCB0NVVEVSVk8CBVN0YXRlB4wHFwcAAgEHAAIBBwECAQcCAgEHAwIBBwQCAQcFAgEHBgIBBwcCAQcBAgEHAAIBBwECAQcCAgEHAwIBBwQCAQcCAgEHAAIBBwICAQcBAgEHAwIBBwQCAQcFAgEHBgIBBwAHAAcABwACAAUAAACACQIABwAJAgACAAMHBAIABwACAQeTBwACAQcABwAHAA%3D%3D&hdpidactividad=127&hdpiddisa=7&hdpidred=0&hdpidmicrored=0&hdpidestablecimiento=0&hdprandoedad=0&hdpfecini=06%2F05%2F2021&hdpfecfin=06%2F05%2F2021&DXScript=1_171%2C1_94%2C1_164%2C1_104%2C1_138%2C1_114%2C1_121%2C1_152&DXCss=0_3598%2C0_3741%2C1_12%2C0_3600%2C0_3745%2C0_3592%2C1_5%2C0_3594",
  "method": "POST",
  "mode": "cors",
  "credentials": "include"
}).then((respuesta)=>{
  respuesta.body.pipe(rpt)
  console.log(respuesta.body)

  
});

    
  }




}
